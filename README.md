# WordPress-Pentesting
Each of the following exploits were demonstrated using [WPDistillery](https://github.com/flurinduerst/WPDistillery) with a stock image of Wordpress (version 4.2).

----

Exploit 1 - Unauthenticated Stored Cross-Site Scripting (XSS)
-------------------------------------------------------------
This exploit affects Wordpress versions 4.2 and earlier [(CVE-2015-3440)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-3440).

Here we take advantage of the fact that there is 64K limit to the size of a comment. When comments are larger than 64K, it gets truncated. This has to do with the size limits of MySQL text.

So our goal will be to post a visible comment that becomes nefarious upon auto-truncation.

#### Proof of Concept:
1. Post a benign comment(s) that gets approved by an admin so that now we can post our malicious comment without needing approval.
2. Post our malicious comment :
```html
<a title='x onmouseover=alert(unescape(/cookies%20yummy/.source)) style=position:absolute;left:0;top:0;width:5000px;height:5000px  AAAAAAAAAAAA...[64 kb]..AAA'></a>
```
3. Wait for an admin to view the page =)

###### Demo:
![](https://raw.githubusercontent.com/notmike/WordPress-Pentesting/master/exploit1-stored_xss/unauthenticated_xss.gif)
*Exploit originally discovered by [Klikki Oy](https://klikki.fi/adv/wordpress2.html)*

----

Exploit 2 - Authenticated Stored Cross-Site Scripting (XSS)
-----------------------------------------------------------
This exploit affects WordPress versions 4.2.2 and earlier [CVE-2015-5622](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5622).

In this attack we'll use a vulnerability in the WYSIWYG editor and how it processes shortcodes, specifically the caption shortcode. As long as we have access to an account with contributor privileges, we can create a post and use the WYSIWYG editor and submit a post for review by an editor or admin. We can also include style attributes to make the exploit be transparent and cover the whole screen on mouseover.

#### Proof of Concept:
1. Get contributor privileges and create a post.
2. Post our malicious shortcode in the WYSIWYG editor:
```javascript
<a href="[caption code=">]</a><a title=" onmouseover=alert('cookies_yum')  ">link</a>
```
3. Submit draft for review and wait for privileged user to open. =)

###### Demo:
![](https://raw.githubusercontent.com/notmike/WordPress-Pentesting/master/exploit2-authenticated_xss/authenticated_xss.gif)
*Exploit originally discovered by [Klikki Oy](https://klikki.fi/adv/wordpress3.html)*

----

Exploit 3 - Authenticated Cross-Site Scripting (XSS) via Media File Metadata
----------------------------------------------------------------------------
WordPress 3.6.0-4.7.2
[CVE-2017-6814](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6814)
###### Demo:
![](https://raw.githubusercontent.com/notmike/WordPress-Pentesting/master/expoloit3-playlist_xss/playlist-shortcode_xss.gif)
*Exploit originally discovered at [The Summer of Pwnage](https://sumofpwn.nl/advisory/2016/wordpress_audio_playlist_functionality_is_affected_by_cross_site_scripting.html)*
